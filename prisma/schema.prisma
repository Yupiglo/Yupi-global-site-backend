generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model LegacyPost {
  id         BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  title      String    @db.VarChar(255)
  content    String    @db.LongText
  author     String    @db.VarChar(255)
  image      String?   @db.VarChar(255)
  is_publish Boolean   @default(false)
  createdAt  DateTime? @map("created_at") @db.Timestamp(0)
  updatedAt  DateTime? @updatedAt @map("updated_at") @db.Timestamp(0)

  @@map("posts")
}

model addresses {
  id         BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  user_id    BigInt    @db.UnsignedBigInt
  city       String?   @db.VarChar(255)
  street     String?   @db.VarChar(255)
  phone      String?   @db.VarChar(255)
  created_at DateTime? @db.Timestamp(0)
  updated_at DateTime? @db.Timestamp(0)

  @@index([user_id], map: "addresses_user_id_index")
}

model banners {
  id                 BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  image              String    @db.VarChar(255)
  title1             String    @db.VarChar(255)
  title2             String    @db.VarChar(255)
  sub_title1         String    @db.VarChar(255)
  btn                String    @db.VarChar(255)
  category           String    @db.VarChar(255)
  is_active          Boolean   @default(true)
  top_banner         Boolean   @default(false)
  promotional_banner Boolean   @default(false)
  sort_order         Int       @default(0)
  created_at         DateTime? @db.Timestamp(0)
  updated_at         DateTime? @db.Timestamp(0)
}

model brands {
  id         BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  name       String    @unique(map: "brands_name_unique") @db.VarChar(255)
  slug       String?   @db.VarChar(255)
  image      String?   @db.VarChar(255)
  created_at DateTime? @db.Timestamp(0)
  updated_at DateTime? @db.Timestamp(0)
}

model cache {
  key        String @id @db.VarChar(255)
  value      String @db.MediumText
  expiration Int
}

model cache_locks {
  key        String @id @db.VarChar(255)
  owner      String @db.VarChar(255)
  expiration Int
}

model cart_items {
  id                     BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  cart_id                BigInt    @db.UnsignedBigInt
  product_id             BigInt    @db.UnsignedBigInt
  quantity               Int       @default(1) @db.UnsignedInt
  price                  Decimal   @default(0.00) @db.Decimal(12, 2)
  total_product_discount Decimal?  @db.Decimal(12, 2)
  created_at             DateTime? @db.Timestamp(0)
  updated_at             DateTime? @db.Timestamp(0)

  @@unique([cart_id, product_id], map: "cart_items_cart_id_product_id_unique")
  @@index([cart_id], map: "cart_items_cart_id_index")
  @@index([product_id], map: "cart_items_product_id_index")
}

model carts {
  id                         BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  user_id                    BigInt    @unique(map: "carts_user_id_unique") @db.UnsignedBigInt
  total_price                Decimal   @default(0.00) @db.Decimal(12, 2)
  total_price_after_discount Decimal?  @db.Decimal(12, 2)
  discount                   Decimal?  @db.Decimal(12, 2)
  created_at                 DateTime? @db.Timestamp(0)
  updated_at                 DateTime? @db.Timestamp(0)

  @@index([user_id], map: "carts_user_id_index")
}

model categories {
  id         BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  name       String    @unique(map: "categories_name_unique") @db.VarChar(255)
  slug       String?   @db.VarChar(255)
  image      String?   @db.VarChar(255)
  created_at DateTime? @db.Timestamp(0)
  updated_at DateTime? @db.Timestamp(0)
}

model coupons {
  id         BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  code       String    @unique(map: "coupons_code_unique") @db.VarChar(255)
  expires    DateTime  @db.DateTime(0)
  discount   Decimal   @db.Decimal(12, 2)
  created_at DateTime? @db.Timestamp(0)
  updated_at DateTime? @db.Timestamp(0)
}

model failed_jobs {
  id         BigInt   @id @default(autoincrement()) @db.UnsignedBigInt
  uuid       String   @unique(map: "failed_jobs_uuid_unique") @db.VarChar(255)
  connection String   @db.Text
  queue      String   @db.Text
  payload    String   @db.LongText
  exception  String   @db.LongText
  failed_at  DateTime @default(now()) @db.Timestamp(0)
}

model job_batches {
  id             String  @id @db.VarChar(255)
  name           String  @db.VarChar(255)
  total_jobs     Int
  pending_jobs   Int
  failed_jobs    Int
  failed_job_ids String  @db.LongText
  options        String? @db.MediumText
  cancelled_at   Int?
  created_at     Int
  finished_at    Int?
}

model jobs {
  id           BigInt @id @default(autoincrement()) @db.UnsignedBigInt
  queue        String @db.VarChar(255)
  payload      String @db.LongText
  attempts     Int    @db.UnsignedTinyInt
  reserved_at  Int?   @db.UnsignedInt
  available_at Int    @db.UnsignedInt
  created_at   Int    @db.UnsignedInt

  @@index([queue], map: "jobs_queue_index")
}

model migrations {
  id        Int    @id @default(autoincrement()) @db.UnsignedInt
  migration String @db.VarChar(255)
  batch     Int
}

model order_items {
  id                     BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  order_id               BigInt    @db.UnsignedBigInt
  product_id             BigInt    @db.UnsignedBigInt
  quantity               Int       @default(1) @db.UnsignedInt
  price                  Decimal   @default(0.00) @db.Decimal(12, 2)
  total_product_discount Decimal?  @db.Decimal(12, 2)
  created_at             DateTime? @db.Timestamp(0)
  updated_at             DateTime? @db.Timestamp(0)

  @@index([order_id], map: "order_items_order_id_index")
  @@index([product_id], map: "order_items_product_id_index")
}

model orders {
  id                BigInt                @id @default(autoincrement()) @db.UnsignedBigInt
  user_id           BigInt                @db.UnsignedBigInt
  shipping_street   String?               @db.VarChar(255)
  shipping_city     String?               @db.VarChar(255)
  shipping_phone    String?               @db.VarChar(255)
  order_status      orders_order_status   @default(processing)
  payment_method    orders_payment_method @default(cash)
  is_paid           Boolean               @default(false)
  is_delivered      Boolean               @default(false)
  total_order_price Decimal               @default(0.00) @db.Decimal(12, 2)
  order_at          DateTime?             @db.DateTime(0)
  paid_at           DateTime?             @db.DateTime(0)
  delivered_at      DateTime?             @db.DateTime(0)
  created_at        DateTime?             @db.Timestamp(0)
  updated_at        DateTime?             @db.Timestamp(0)

  @@index([user_id], map: "orders_user_id_index")
}

model password_reset_tokens {
  email      String    @id @db.VarChar(255)
  token      String    @db.VarChar(255)
  created_at DateTime? @db.Timestamp(0)
}

model personal_access_tokens {
  id             BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  tokenable_type String    @db.VarChar(255)
  tokenable_id   BigInt    @db.UnsignedBigInt
  name           String    @db.Text
  token          String    @unique(map: "personal_access_tokens_token_unique") @db.VarChar(64)
  abilities      String?   @db.Text
  last_used_at   DateTime? @db.Timestamp(0)
  expires_at     DateTime? @db.Timestamp(0)
  created_at     DateTime? @db.Timestamp(0)
  updated_at     DateTime? @db.Timestamp(0)

  @@index([expires_at], map: "personal_access_tokens_expires_at_index")
  @@index([tokenable_type, tokenable_id], map: "personal_access_tokens_tokenable_type_tokenable_id_index")
}

model products {
  id          BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  title       String    @db.VarChar(255)
  description String    @db.LongText
  type        String?   @db.VarChar(255)
  brand       String?   @db.VarChar(255)
  category    String    @db.VarChar(255)
  price       Decimal   @db.Decimal(12, 2)
  is_new      Boolean   @default(false)
  is_sale     Boolean   @default(false)
  discount    Decimal   @default(0.00) @db.Decimal(12, 2)
  img_cover   String?   @db.VarChar(255)
  variants    Json?
  images      Json?
  quantity    Int       @default(0) @db.UnsignedInt
  sold        Int       @default(0) @db.UnsignedInt
  created_at  DateTime? @db.Timestamp(0)
  updated_at  DateTime? @db.Timestamp(0)
}

model reviews {
  id         BigInt         @id @default(autoincrement()) @db.UnsignedBigInt
  text       String         @db.Text
  product_id BigInt         @db.UnsignedBigInt
  user_id    BigInt         @db.UnsignedBigInt
  rate       Int            @default(5) @db.UnsignedTinyInt
  status     reviews_status @default(pending)
  created_at DateTime?      @db.Timestamp(0)
  updated_at DateTime?      @db.Timestamp(0)

  @@index([product_id], map: "reviews_product_id_index")
  @@index([user_id], map: "reviews_user_id_index")
}

model sessions {
  id            String  @id @db.VarChar(255)
  user_id       BigInt? @db.UnsignedBigInt
  ip_address    String? @db.VarChar(45)
  user_agent    String? @db.Text
  payload       String  @db.LongText
  last_activity Int

  @@index([last_activity], map: "sessions_last_activity_index")
  @@index([user_id], map: "sessions_user_id_index")
}

model settings {
  id         BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  site_name  String?   @db.VarChar(255)
  logo       String?   @db.VarChar(255)
  phone      String?   @db.VarChar(255)
  email      String?   @db.VarChar(255)
  address    String?   @db.VarChar(255)
  facebook   String?   @db.VarChar(255)
  instagram  String?   @db.VarChar(255)
  twitter    String?   @db.VarChar(255)
  youtube    String?   @db.VarChar(255)
  created_at DateTime? @db.Timestamp(0)
  updated_at DateTime? @db.Timestamp(0)
}

model subcategories {
  id          BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  name        String    @db.VarChar(255)
  slug        String?   @db.VarChar(255)
  category_id BigInt    @db.UnsignedBigInt
  created_at  DateTime? @db.Timestamp(0)
  updated_at  DateTime? @db.Timestamp(0)

  @@index([category_id], map: "subcategories_category_id_index")
}

model users {
  id                BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  name              String    @db.VarChar(255)
  username          String?   @unique(map: "users_username_unique") @db.VarChar(255)
  role              String    @default("user") @db.VarChar(255)
  email             String    @unique(map: "users_email_unique") @db.VarChar(255)
  email_verified_at DateTime? @db.Timestamp(0)
  password          String    @db.VarChar(255)
  remember_token    String?   @db.VarChar(100)
  created_at        DateTime? @db.Timestamp(0)
  updated_at        DateTime? @db.Timestamp(0)
}

model wishlist_items {
  id          BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  wishlist_id BigInt    @db.UnsignedBigInt
  product_id  BigInt    @db.UnsignedBigInt
  created_at  DateTime? @db.Timestamp(0)
  updated_at  DateTime? @db.Timestamp(0)

  @@unique([wishlist_id, product_id], map: "wishlist_items_wishlist_id_product_id_unique")
  @@index([product_id], map: "wishlist_items_product_id_index")
  @@index([wishlist_id], map: "wishlist_items_wishlist_id_index")
}

model wishlists {
  id         BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  user_id    BigInt    @unique(map: "wishlists_user_id_unique") @db.UnsignedBigInt
  created_at DateTime? @db.Timestamp(0)
  updated_at DateTime? @db.Timestamp(0)

  @@index([user_id], map: "wishlists_user_id_index")
}

enum orders_order_status {
  processing
  pending
  shipped
  delivered
  canceled
}

enum reviews_status {
  pending
  approved
  rejected
}

enum orders_payment_method {
  card
  cash
}
// --- Original CMS Models ---

model Page {
  id              Int       @id @default(autoincrement())
  title           String    @db.VarChar(255)
  slug            String    @unique @db.VarChar(255)
  content         String?   @db.Text
  excerpt         String?   @db.Text
  featuredImageId Int?
  status          String    @default("draft") @db.VarChar(50)
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  featuredImage Media? @relation("PageFeaturedImage", fields: [featuredImageId], references: [id])

  @@map("cms_pages")
}

model Portfolio {
  id              Int       @id @default(autoincrement())
  title           String    @db.VarChar(255)
  slug            String    @unique @db.VarChar(255)
  description     String?   @db.Text
  featuredImageId Int?
  category        String?   @db.VarChar(100)
  status          String    @default("draft") @db.VarChar(50)
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  featuredImage Media? @relation("PortfolioFeaturedImage", fields: [featuredImageId], references: [id])

  @@map("cms_portfolio")
}

model Service {
  id              Int       @id @default(autoincrement())
  title           String    @db.VarChar(255)
  slug            String    @unique @db.VarChar(255)
  description     String?   @db.Text
  icon            String?   @db.VarChar(100)
  featuredImageId Int?
  status          String    @default("draft") @db.VarChar(50)
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  featuredImage Media? @relation("ServiceFeaturedImage", fields: [featuredImageId], references: [id])

  @@map("cms_services")
}

model Media {
  id               Int       @id @default(autoincrement())
  filename         String    @db.VarChar(255)
  originalFilename String?   @map("original_filename") @db.VarChar(255)
  mimeType         String?   @map("mime_type") @db.VarChar(100)
  size             Int?
  url              String    @db.VarChar(500)
  altText          String?   @map("alt_text") @db.VarChar(255)
  createdAt        DateTime  @default(now()) @map("created_at")

  // Relations
  pagesAsFeatured     Page[]      @relation("PageFeaturedImage")
  postsAsFeatured     Post[]      @relation("PostFeaturedImage")
  portfolioAsFeatured Portfolio[] @relation("PortfolioFeaturedImage")
  servicesAsFeatured  Service[]    @relation("ServiceFeaturedImage")

  @@map("cms_media")
}

model Member {
  id        Int       @id @default(autoincrement())
  firstName String    @map("first_name") @db.VarChar(100)
  lastName  String    @map("last_name") @db.VarChar(100)
  email     String    @unique @db.VarChar(255)
  phone     String?   @db.VarChar(50)
  country   String?   @db.VarChar(100)
  city      String?   @db.VarChar(100)
  company   String?   @db.VarChar(255)
  position  String?   @db.VarChar(100)
  source    String?   @db.VarChar(100) // Comment il a connu Yupi
  status    String    @default("pending") @db.VarChar(50)
  createdAt DateTime  @default(now()) @map("created_at")
  updatedAt DateTime  @updatedAt @map("updated_at")

  @@map("cms_members")
}

model Admin {
  id           Int       @id @default(autoincrement())
  username     String    @unique @db.VarChar(100)
  email        String    @unique @db.VarChar(255)
  passwordHash String    @map("password_hash") @db.VarChar(255)
  role         String    @default("editor") @db.VarChar(50)
  createdAt    DateTime  @default(now()) @map("created_at")
  updatedAt    DateTime  @updatedAt @map("updated_at")

  posts Post[]

  @@map("cms_admins")
}

model Post {
  id              Int       @id @default(autoincrement())
  title           String    @db.VarChar(255)
  slug            String    @unique @db.VarChar(255)
  content         String?   @db.Text
  excerpt         String?   @db.Text
  featuredImageId Int?
  authorId        Int?
  status          String    @default( "draft") @db.VarChar(50)
  publishedAt     DateTime? @map("published_at")
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  featuredImage Media? @relation("PostFeaturedImage", fields: [featuredImageId], references: [id])
  author        Admin? @relation(fields: [authorId], references: [id])

  @@map("cms_posts")
}
